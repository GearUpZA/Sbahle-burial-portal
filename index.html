<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Welcome to Sbahle Burial Society</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="styles.css">
  <!-- External scripts disabled to prevent conflicts -->
  <!-- <script src="init-attendance.js"></script> -->
  <!-- <script src="sbs-init.js"></script> -->
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; background: #667eea; min-height: 100vh; padding: 20px; }
    .container { max-width: 1200px; margin: 0 auto; }
    .card { background: white; border-radius: 10px; padding: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
    .hidden { display: none !important; }
    .desc-text { color: #666; font-size: 13px; margin-bottom: 10px; }

    .signature-info-box {
      background: #f0f9ff;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      border-left: 4px solid #667eea;
    }
    
    /* Tab visibility fixes - override hidden class when tabs should be visible */
    #membersTab:not(.hidden), #beneficiariesTab:not(.hidden), #payoutsTab:not(.hidden), #penaltiesTab:not(.hidden) {
      display: block !important;
      min-height: 500px !important;
      padding: 20px !important;
      background: white !important;
      border: 1px solid #ddd !important;
      overflow: visible !important;
    }
    #membersTab {
      min-height: 400px;
    }
    #beneficiariesTab {
      min-height: 400px;
    }

    #payoutsTab {
      min-height: 400px;
    }

    #penaltiesTab {
      min-height: 400px;
    }
    
    /* Force table layout */
    #membersTab table, #beneficiariesTab table, #payoutsTab table, #penaltiesTab table {
      display: table !important;
      width: 100% !important;
      table-layout: fixed !important;
      border-collapse: collapse !important;
    }
    
    #membersTab tbody, #beneficiariesTab tbody, #payoutsTab tbody, #penaltiesTab tbody {
      display: table-row-group !important;
    }
    
    #membersTab tr, #beneficiariesTab tr, #payoutsTab tr, #penaltiesTab tr {
      display: table-row !important;
      height: 45px !important;
      border-bottom: 1px solid #ddd !important;
    }
    
    #membersTab td, #beneficiariesTab td, #payoutsTab td, #penaltiesTab td,
    #membersTab th, #beneficiariesTab th, #payoutsTab th, #penaltiesTab th {
      display: table-cell !important;
      padding: 12px 8px !important;
      vertical-align: middle !important;
      border: 1px solid #ddd !important;
      background: white !important;
    }
    h1 { color: #333; margin-bottom: 20px; }
    h2 { color: #333; margin: 15px 0; font-size: 20px; }
    .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
    .tabs { display: flex; gap: 5px; margin-bottom: 15px; flex-wrap: wrap; }
    .tab { padding: 8px 15px; background: #e2e8f0; border: none; cursor: pointer; font-weight: 600; border-radius: 5px; }
    .tab.active { background: #667eea; color: white; }
    .form-group { margin-bottom: 12px; }
    label { display: block; margin-bottom: 3px; color: #333; font-weight: bold; font-size: 14px; }
    input, select, textarea { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 5px; font-size: 14px; }
    input:disabled { background: #f0f0f0; }
    .btn { padding: 8px 15px; border: none; border-radius: 5px; cursor: pointer; font-weight: 600; margin-right: 5px; margin-bottom: 5px; font-size: 13px; }
    .btn-primary { background: #667eea; color: white; }
    .btn-success { background: #48bb78; color: white; }
    .btn-danger { background: #f56565; color: white; }
    .btn-warning { background: #ed8936; color: white; }
    .btn-sm { padding: 5px 10px; font-size: 12px; }
    .alert { padding: 10px; border-radius: 5px; margin-bottom: 15px; font-size: 13px; }
    .alert-success { background: #c6f6d5; color: #22543d; border-left: 4px solid #48bb78; }
    .alert-error { background: #fed7d7; color: #742a2a; border-left: 4px solid #f56565; }
    .alert-warning { background: #feebc8; color: #7c2d12; border-left: 4px solid #ed8936; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 13px; }
    thead { background: #667eea; color: white; }
    th, td { padding: 8px; text-align: left; border-bottom: 1px solid #ddd; }
    tbody tr:hover { background: #f7f7f7; }
    .badge { padding: 3px 8px; border-radius: 12px; font-size: 11px; font-weight: 600; display: inline-block; }
    .badge-active { background: #c6f6d5; color: #22543d; }
    .badge-suspended { background: #fed7d7; color: #742a2a; }
    .badge-pending { background: #feebc8; color: #744210; }
    .badge-approved { background: #bee3f8; color: #2c5282; }
    .stat { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px; border-radius: 8px; margin-bottom: 10px; }
    .stat h3 { font-size: 12px; margin-bottom: 8px; }
    .stat .value { font-size: 24px; font-weight: bold; }
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 1000; }
    .modal.show { display: flex; align-items: center; justify-content: center; }
    .modal-content { background: white; border-radius: 10px; padding: 25px; max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto; }
    .close { float: right; font-size: 20px; cursor: pointer; color: #999; }
    .close:hover { color: #000; }
    .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .ben-card { background: #f7f7f7; padding: 10px; border-radius: 5px; margin-bottom: 8px; border-left: 3px solid #667eea; display: block !important; visibility: visible !important; }
    canvas { border: 1px solid #ccc; border-radius: 5px; display: block; margin-bottom: 10px; cursor: crosshair; }
    .file-input { margin-bottom: 10px; }
    .file-label { display: block; padding: 10px; background: #e2e8f0; border: 2px dashed #667eea; border-radius: 5px; text-align: center; cursor: pointer; font-size: 13px; }
    .file-label:hover { background: #cbd5e0; }
    .overflow-x-auto { overflow-x: auto; margin-top: 20px; }
    @media (max-width: 768px) { .grid-2 { grid-template-columns: 1fr; } .header { flex-direction: column; align-items: flex-start; } }
    .members-table-container {
      overflow-x: auto;
      margin-top: 20px;
      min-height: 300px;
    }
    .members-table {
      width: 100%;
      border-collapse: collapse;
      display: table;
      background: white;
    }
    .members-table-header {
      display: table-header-group;
      background: #667eea;
      color: white;
    }
    #memTable {
      display: table-row-group;
      background: white;
    }
    .members-table-header tr {
      display: table-row;
    }
    .members-table-row {
      display: table-row;
    }
    .members-table-cell {
      display: table-cell;
      padding: 12px;
      border: 1px solid #ddd;
    }
    .custom-table-header {
      display: table-header-group;
      background: #667eea;
      color: white;
    }
    .table-cell-missed {
      display: table-cell;
      padding: 12px;
      border: 1px solid #ddd;
    }
    .table-cell-actions {
      display: table-cell;
      padding: 12px;
      border: 1px solid #ddd;
    }
    .custom-table {
      width: 100%;
      border-collapse: collapse;
      display: table;
    }
    .penalties-table {
      width: 100%;
      border-collapse: collapse;
      display: table;
    }
    .penalties-table-container {
      overflow-x: auto;
      margin-top: 20px;
    }
    .custom-table-row {
      display: table-row;
    }
    .custom-table-header-cell {
      display: table-cell;
      padding: 12px;
      border: 1px solid #ddd;
    }
    #payTable {
      display: table-row-group;
    }
    .info-bar {
      display: flex;
      gap: 10px;
      font-size: 12px;
      color: #666;
    }
    .location-device-info {
      display: flex;
      gap: 10px;
      font-size: 12px;
      color: #666;
    }
    .custom-section {
      background: white;
      padding: 15px;
      border-radius: 8px;
    }
    .analytics-section {
      background: white;
      padding: 15px;
      border-radius: 8px;
    }
    .btn-mt-10 {
      margin-top: 10px;
    }
    .mt-30 {
      margin-top: 30px;
    }
    .mb-15 {
      margin-bottom: 15px;
    }
    .data-management-grid {
      display: grid;
      gap: 15px;
    }
  .data-management-inner-grid {
    display: grid;
    gap: 15px;
  }
    .mt-20 {
      margin-top: 20px;
    }
    .data-management-info-box {
      background: #f0f9ff;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      border-left: 4px solid #667eea;
    }
    .data-management-grid {
      display: grid;
      gap: 15px;
    }
    .data-management-box {
      background: white;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
    }
    .data-management-title {
      margin-bottom: 10px;
      font-size: 16px;
    }
    .mb-10 {
      margin-bottom: 10px;
    }
    .desc-text {
      color: #666;
      font-size: 13px;
      margin-bottom: 10px;
    }
    .mb-10 {
      margin-bottom: 10px;
    }
    .data-management-box {
      background: white;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
    }
    .data-management-title {
      margin-bottom: 10px;
      font-size: 16px;
    }
    .mb-10 {
      margin-bottom: 10px;
    }
    .desc-text {
      color: #666;
      font-size: 13px;
      margin-bottom: 10px;
    }
    .manual-save-box {
      background: white;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
    }
    .manual-save-title {
      margin-bottom: 10px;
      font-size: 16px;
    }
    .manual-save-desc {
      color: #666;
      font-size: 13px;
      margin-bottom: 10px;
    }
    .manual-save-title {
      margin-bottom: 10px;
      font-size: 16px;
    }
    .clear-all-title {
      margin-bottom: 10px;
      font-size: 16px;
    }
    .clear-all-data-box {
      background: #fff4e6;
      padding: 15px;
      border: 1px solid #ed8936;
      border-radius: 8px;
    }
    .clear-all-desc {
      color: #666;
      font-size: 13px;
      margin-bottom: 10px;
    }
    .storage-info-box {
      background: white;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
    }
    .storage-info-title {
      margin-bottom: 10px;
      font-size: 16px;
    }
    .storage-info-text {
      color: #666;
      font-size: 13px;
    }
    .storage-info-text-last {
      margin-bottom: 0;
    }
    #currentSignature {
      display: none;
    }
    #savedSignature {
      max-width: 100%;
      border: 1px solid #ddd;
      border-radius: 5px;
    }
    .beneficiary-info-text {
      color: #666;
      margin-bottom: 15px;
    }
    .no-beneficiaries-msg {
      text-align: center;
      color: #999;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- LOGIN PAGE -->
    <div id="loginPage" class="card">
      <h1 class="align-center">üèõÔ∏è Sbahle Burial Society</h1>
      <div class="tabs justify-center">
        <button class="tab active" onclick="showLoginForm('admin')">Admin</button>
        <button class="tab" onclick="showLoginForm('member')">Member</button>
        <button class="tab" onclick="showLoginForm('register')">Register</button>
      </div>
      <div id="alertMsg"></div>

      <div id="adminForm">
        <h2>Admin Login</h2>
        <div class="form-group"><label>Email</label><input type="text" id="adminEmail" value="admin" placeholder="Enter admin email" title="Admin Email"></div>
        <div class="form-group"><label>Password</label><input type="password" id="adminPassword" value="admin123" placeholder="Enter admin password" title="Admin Password"></div>
        <button class="btn btn-primary" onclick="loginAdmin()">Login</button>
      </div>

      <div id="memberForm" class="hidden">
        <h2>Member Login</h2>
        <div class="form-group"><label>Email</label><input type="text" id="memberEmail" value="member@test.com"></div>
        <button class="btn btn-primary" onclick="loginMember()">Login</button>
      </div>

      <div id="registerForm" class="hidden">
        <h2>Register Member</h2>
        <div class="form-group"><label>Name</label><input type="text" id="regName"></div>
        <div class="form-group"><label>Email</label><input type="text" id="regEmail"></div>
        <div class="form-group"><label>Phone</label><input type="text" id="regPhone"></div>
        <div class="form-group"><label>ID Number</label><input type="text" id="regId"></div>
        <button class="btn btn-success" onclick="registerMember()">Register</button>
      </div>
    </div>

    <!-- ADMIN DASHBOARD -->
    <div id="adminPage" class="card hidden">
      <div class="header">
        <h1>Admin Dashboard</h1>
        <button class="btn btn-danger" onclick="logout()">Logout</button>
      </div>
      <div class="tabs">
        <button class="tab active" onclick="adminTab('overview', event)">Overview</button>
        <button class="tab" onclick="adminTab('members', event)">Members</button>
        <button class="tab" onclick="adminTab('beneficiaries', event)">Beneficiaries</button>
        <button class="tab" onclick="adminTab('attendance', event)">Attendance</button>
        <button class="tab" onclick="adminTab('payouts', event)">Payouts</button>
        <button class="tab" onclick="adminTab('penalties', event)">Penalties</button>
        <button class="tab" onclick="adminTab('data', event)">Data Management</button>
      </div>
      <div id="adminAlert"></div>

      <div id="overviewTab">
        <div class="stat"><h3>Total Members</h3><div class="value" id="totalMem">5</div></div>
        <div class="stat"><h3>Active Members</h3><div class="value" id="activeMem">4</div></div>
        <div class="stat"><h3>Suspended</h3><div class="value" id="suspMem">1</div></div>
        <button class="btn btn-warning" onclick="checkMissed()">Check Missed Payments</button>
        <button class="btn btn-warning" onclick="applyPen()">Apply R30 Penalties</button>
      </div>

      <!-- Attendance Tab -->
      <div id="attendanceTab" class="hidden">
        <h2>Meeting Attendance</h2>
          <div class="bg-blue-50 p-15 rounded-8 mb-20">
            <p><strong>üìã Manage meeting attendance and track member participation</strong></p>
            <p class="mt-10 text-gray">Track attendance, manage meetings, and generate reports</p>
          </div>

          <!-- Meeting Details Section -->
          <div class="grid-2 grid-gap-15">
            <div class="form-group m-0">
              <label>Meeting Date</label>
              <input type="date" id="meetingDate" onchange="showAttendanceList()">
            </div>
            <div class="form-group m-0">
              <label>Meeting Time</label>
              <input type="time" id="meetingTime" onchange="updateMeetingDetails()">
            </div>
          </div>
        
          <div class="grid-2 grid-gap-15 mt-15">
            <div class="form-group m-0">
              <label>Meeting Type</label>
              <select id="meetingType" onchange="updateMeetingDetails()">
                <option value="general">General Meeting</option>
                <option value="committee">Committee Meeting</option>
                <option value="special">Special Meeting</option>
                <option value="emergency">Emergency Meeting</option>
              </select>
            </div>
            <div class="form-group m-0">
              <label>Meeting Description</label>
              <textarea id="meetingDesc" rows="2" onchange="updateMeetingDetails()" 
                        placeholder="Brief description of meeting agenda/purpose"></textarea>
            </div>
          </div>

          <!-- Search and Filter Section -->
          <div class="bg-blue-100 p-15 rounded-8 mt-20 mb-20">
            <div class="grid-2 grid-gap-15">
              <div class="form-group m-0">
                <input type="text" id="memberSearch" 
                       placeholder="Search members..." 
                       onkeyup="filterMembers()"
                       class="m-0">
              </div>
              <div class="d-flex grid-gap-10">
                <select id="statusFilter" onchange="filterMembers()" class="w-auto">
                  <option value="all">All Status</option>
                  <option value="present">Present Only</option>
                  <option value="absent">Absent Only</option>
                  <option value="nosig">No Signature</option>
                </select>
                <select id="sortBy" onchange="filterMembers()" class="w-auto">
                  <option value="name">Sort by Name</option>
                  <option value="time">Sort by Time In</option>
                  <option value="status">Sort by Status</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Attendance Stats -->
          <div class="bg-blue-200 p-15 rounded-8 mb-20">
            <div class="d-flex justify-content-between align-center">
              <div>
                <span id="presentCount" class="badge badge-active mr-10">Present: 0</span>
                <span id="absentCount" class="badge badge-suspended mr-10">Absent: 0</span>
                <span id="attendanceRate" class="badge badge-approved">Attendance Rate: 0%</span>
              </div>
              <div>
                <button class="btn btn-primary btn-sm" onclick="markAllPresent()">Mark All Present</button>
                <button class="btn btn-warning btn-sm" onclick="clearAttendance()">Clear All</button>
                <button class="btn btn-success" onclick="downloadAttendanceRegister()" id="downloadRegisterBtn">
                  <span class="mr-5">üì•</span> Download Register
                </button>
              </div>
            </div>
        </div>

        <!-- Attendance List -->
        <div class="table-container mt-20">
          <table class="table w-100">
            <thead>
              <tr>
                <th>Member Name</th>
                <th>Status</th>
                  <th>Time</th>
                  <th>Signature</th>
            <thead class="members-table-header">
              <tr>
                <th class="members-table-cell">ID</th>
                <th class="members-table-cell">Name</th>
                <th class="members-table-cell">Email</th>
                <th class="members-table-cell">Status</th>
                <th class="members-table-cell">Missed</th>
                <th class="members-table-cell">Actions</th>
            <thead class="custom-table-header">
            </thead>
        <button class="btn btn-success" onclick="addMemberModal()">+ Add Member</button>
              <tr class="members-table-row">
                <th class="members-table-cell">ID</th>
                <th class="members-table-cell">Name</th>
                <th class="table-cell-missed">Missed</th>
                <th class="table-cell-actions">Actions</th>
                <th class="members-table-cell">Missed</th>
                <th class="members-table-cell">Actions</th>
              </tr>
            <tbody id="memTable"></tbody>
                <th class="table-cell-actions">Actions</th>
              </tr>
            </thead>
            <tbody id="memTable"></tbody>
          </table>
      <div id="beneficiariesTab" class="hidden">
      </div>

      <div id="beneficiariesTab" class="hidden">
        <h2>Beneficiaries</h2>
        <div class="form-group">
          <label>Select Member</label>
          <select id="memSelectBen" onchange="loadBeneficiaries()">
            <option value="">-- Select --</option>
          </select>
        </div>
        <button class="btn btn-success d-none" id="addBenBtn" onclick="addBenModal()">+ Add Beneficiary</button>
        <div class="overflow-x-auto mt-20">
          <table id="benTable" class="w-100 table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Relationship</th>
                <th>ID</th>
                <th>%</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="benTableBody"></tbody>
      <div id="payoutsTab" class="hidden">
          <table class="custom-table">
      </div>

                <th class="custom-table-header-cell">Member</th>
              <tr class="custom-table-row">
          <table class="custom-table">
            <thead class="custom-table-header">
              <tr class="custom-table-row">
                <th class="custom-table-header-cell">Member</th>
                <th class="custom-table-header-cell">Amount</th>
                <th class="custom-table-header-cell">Reason</th>
                <th class="custom-table-header-cell">Status</th>
            <tbody id="payTable"></tbody>
              </tr>
            </thead>
            <tbody id="payTable"></tbody>
          </table>
      <div id="penaltiesTab" class="hidden">
        </div>
        <div class="penalties-table-container">
          <table class="penalties-table">
            <thead>
              <tr>
                <th>Member</th>
                <th>Amount</th>
                <th>Date</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="penTable"></tbody>
          </table>
        </div>
            </thead>
            <tbody id="penTable" style="display: table-row-group;"></tbody>
          </table>
          <div class="location-device-info">
            <div id="locationInfo">üìç Location: <span>Not detected</span></div>
            <div id="deviceInfo">üì± Device: <span>Unknown</span></div>
          </div>
          
          <!-- Location and Device Info -->
          <div class="location-device-info">
            <div id="locationInfo">üìç Location: <span>Not detected</span></div>
            <div id="deviceInfo">üì± Device: <span>Unknown</span></div>
          </div>
        </div>
            <div class="analytics-section">
              <h4>Monthly Attendance Trend</h4>
              <canvas id="attendanceTrendChart" height="200"></canvas>
            </div>
            <div class="analytics-section">
              <h4>Member Participation</h4>
              <canvas id="memberParticipationChart" height="200"></canvas>
            </div>
            </div>
            <div class="analytics-section">
              <h4>Member Participation</h4>
          <button class="btn btn-primary btn-mt-10" onclick="toggleAnalytics()">
            Hide Analytics
          </button>
          <button class="btn btn-primary btn-mt-10" onclick="toggleAnalytics()">
            Hide Analytics
          </button>
        </div>
        
        <!-- Analytics Toggle -->
        <button class="btn btn-primary" onclick="toggleAnalytics()" id="showAnalyticsBtn">
          Show Analytics
        </button>

        <!-- Attendance Table -->
        <div id="attendanceSheet">
          <table id="attendanceTable">
            <thead>
              <tr>
                <th>#</th>
                <th>Member Name</th>
                <th>Status</th>
                <th>Time In</th>
                <th>Remarks</th>
                <th>Signature</th>
              </tr>
            </thead>
            <tbody id="attendanceTableBody">
              <!-- Members will be listed here -->
            </tbody>
          </table>
        <div class="mt-30">
          <h3>Recent Meetings</h3>
          <table id="meetingHistoryTable">
            <thead>
              <tr>
                <th>Date</th>
                <th>Type</th>
                <th>Attendance</th>
                <th>Actions</th>
              </tr>
            </thead>
          <div class="data-management-box">
            <h3 class="data-management-title">üì• Export Data</h3>
            <p class="desc-text mb-10">Download a backup of all system data as a JSON file.</p>
            <button class="btn btn-primary" onclick="exportData()">Export Data Backup</button>
          </div>
        <div class="data-management-info-box">
          </table>
        </div>
      </div>
            <p class="desc-text mb-10">Download a backup of all system data as a JSON file.</p>
      <div id="dataTab" class="hidden">
            <p class="desc-text mb-10">Download a backup of all system data as a JSON file.</p>
          <div class="data-management-box">
            <p class="desc-text">Download a backup of all system data as a JSON file.</p>
            <p class="desc-text mb-10">Download a backup of all system data as a JSON file.</p>
            <button class="btn btn-primary" onclick="exportData()">Export Data Backup</button>
          <div class="manual-save-box">
            <h3 class="manual-save-title">üíæ Manual Save</h3>
            <p class="manual-save-desc">Force save all current data (normally happens automatically).</p>
            <button class="btn btn-primary" onclick="saveDataToStorage() && showAlert('adminAlert', '‚úì Data saved successfully!', 'success')">Save Now</button>
          </div>
            <button class="btn btn-primary" onclick="exportData()">Export Data Backup</button>
          </div>
          
          <div class="data-management-box">
            <h3 class="data-management-title">üì§ Import Data</h3>
          <div class="storage-info-box">
            <h3 class="storage-info-title">üìä Storage Info</h3>
            <p class="storage-info-text"><strong>Members:</strong> <span id="storageMembers">0</span></p>
            <p class="storage-info-text"><strong>Beneficiaries:</strong> <span id="storageBeneficiaries">0</span></p>
            <p class="storage-info-text"><strong>Payouts:</strong> <span id="storagePayouts">0</span></p>
            <p class="storage-info-text storage-info-text-last"><strong>Penalties:</strong> <span id="storagePenalties">0</span></p>
          </div>
            <p class="manual-save-desc">Force save all current data (normally happens automatically).</p>
            <h3 class="clear-all-title">‚ö† Clear All Data</h3>
          </div>
          
          <div class="clear-all-data-box">
            <h3 class="clear-all-title">‚ö† Clear All Data</h3>
            <p class="clear-all-desc">Permanently delete all data and reset the system.</p>
            <button class="btn btn-danger" onclick="clearAllData()">Clear All Data</button>
          </div>
          
          <div class="storage-info-box">
            <h3 class="storage-info-title">üìä Storage Info</h3>
            <p class="storage-info-text"><strong>Members:</strong> <span id="storageMembers">0</span></p>
            <p class="storage-info-text"><strong>Beneficiaries:</strong> <span id="storageBeneficiaries">0</span></p>
            <p class="storage-info-text"><strong>Payouts:</strong> <span id="storagePayouts">0</span></p>
            <p class="storage-info-text storage-info-text-last"><strong>Penalties:</strong> <span id="storagePenalties">0</span></p>
          </div>
        </div>
      </div>
    </div>

    <!-- MEMBER DASHBOARD -->
    <div id="memberPage" class="card hidden">
      <div class="header">
        <h1>Member Dashboard</h1>
        <button class="btn btn-danger" onclick="logout()">Logout</button>
      </div>
      <div class="tabs">
        <button class="tab active" onclick="memberTab('profile', event)">Profile</button>
        <button class="tab" onclick="memberTab('signature', event)">Signature</button>
        <button class="tab" onclick="memberTab('contributions', event)">Contributions</button>
        <button class="tab" onclick="memberTab('beneficiaries', event)">Beneficiaries</button>
        <button class="tab" onclick="memberTab('documents', event)">Documents</button>
      </div>
      <div id="memberAlert"></div>

      <div id="memberProfileTab">
        <h2>Profile</h2>
        <div class="form-group">
          <label>Name</label>
          <input type="text" id="profName" disabled>
        </div>
        <div class="form-group">
          <label>Email</label>
          <input type="text" id="profEmail" disabled>
        </div>
        <div class="form-group">
          <label>Phone</label>
        <div class="signature-info-box">
          <p><strong>‚úçÔ∏è Draw your signature below:</strong></p>
        </div>
        <button class="btn btn-success hidden" id="saveProf" onclick="saveProf()">Save</button>
      </div>

      <div id="memberSignatureTab" class="hidden">
        <h2>Digital Signature</h2>
        <div class="signature-info-box">
        <div class="mb-15">
          <button class="btn btn-warning" onclick="clearSignature()">Clear</button>
          <button class="btn btn-success" onclick="saveSignature()">Save Signature</button>
        </div>
          <img id="savedSignature">
          <button class="btn btn-success" onclick="saveSignature()">Save Signature</button>
        </div>
        <div id="currentSignature" class="hidden">
          <h3>Your Current Signature:</h3>
          <img id="savedSignature">
        </div>
      </div>
      <div class="header">
        <h1>Member Dashboard</h1>
        <button class="btn btn-danger" onclick="logout()">Logout</button>
      </div>
      <div class="tabs">
        <button class="tab active" onclick="memberTab('profile', event)">Profile</button>
        <button class="tab" onclick="memberTab('contributions', event)">Contributions</button>
        <button class="tab" onclick="memberTab('beneficiaries', event)">Beneficiaries</button>
        <button class="tab" onclick="memberTab('documents', event)">Documents</button>
        <button class="tab" onclick="memberTab('signature', event)">Signature</button>
        <button class="tab" onclick="memberTab('payouts', event)">Payouts</button>
      </div>
      <div id="memberAlert"></div>

      <div id="profileTab">
        <h2>My Profile</h2>
        <p><strong>Member ID:</strong> <span id="memId">MEM001</span></p>
        <p><strong>Status:</strong> <span id="memStatus" class="badge badge-active">Active</span></p>
        <div class="form-group"><label>Name</label><input type="text" id="profName" disabled></div>
        <div class="form-group"><label>Email</label><input type="text" id="profEmail" disabled></div>
        <div class="form-group"><label>Phone</label><input type="text" id="profPhone" disabled></div>
        <button class="btn btn-primary" onclick="editProf()">Edit</button>
        <button class="btn btn-success hidden" id="saveProf" onclick="saveProf()">Save</button>
      </div>

      <div id="contributionsTab" class="hidden">
        <h2>Contributions - R 170/Month Required</h2>
        <button class="btn btn-success" onclick="addContribModal()">+ Add Contribution</button>
        <table>
          <thead><tr><th>Date</th><th>Amount</th><th>Method</th><th>Status</th></tr></thead>
          <tbody>
            <tr><td>2025-03-15</td><td>R 170</td><td>Bank Transfer</td><td><span class="badge badge-approved">Verified</span></td></tr>
          </tbody>
        </table>
        <p class="beneficiary-info-text">You can add up to 5 beneficiaries. Total allocation must equal 100%.</p>

      <div id="memberBeneficiariesTab" class="hidden">
        <h2>My Beneficiaries</h2>
        <p class="beneficiary-info-text">You can add up to 5 beneficiaries. Total allocation must equal 100%.</p>
        <table class="mt-20">
        <button class="btn btn-primary hidden" id="saveBenMemBtn" onclick="saveBenMem()">Save & Lock</button>
        
        <table class="mt-20">
          <thead>
            <tr>
              <th>Name</th>
              <th>Relationship</th>
              <th>ID Number</th>
              <th>Allocation %</th>
            <tr><td colspan="5" class="no-beneficiaries-msg">No beneficiaries added yet</td></tr>
            </tr>
          </thead>
          <tbody id="memBenTableBody">
            <tr><td colspan="5" class="no-beneficiaries-msg">No beneficiaries added yet</td></tr>
          </tbody>
        </table>
      </div>

      <div id="documentsTab" class="hidden">
        <h2>Upload Documents</h2>
        <div class="file-input">
          <label>Proof of Payment (PDF/JPEG)</label>
          <input type="file" id="payFile" accept=".pdf,.jpg,.jpeg">
        </div>
        <div class="file-input">
          <label>Death Certificate (PDF/JPEG)</label>
          <input type="file" id="deathFile" accept=".pdf,.jpg,.jpeg">
        </div>
        <div class="file-input">
          <label>Supporting Documents (PDF/JPEG)</label>
          <input type="file" id="suppFile" accept=".pdf,.jpg,.jpeg">
        </div>
        <button class="btn btn-success" onclick="saveDocs()">Save Documents</button>
      </div>

      <div id="signatureTab" class="hidden">
        <h2>Digital Signature</h2>
        <p class="signature-instruction">Draw your signature below:</p>
        <canvas id="sigCanvas" width="500" height="150"></canvas>
        <button class="btn btn-secondary" onclick="clearSig()">Clear</button>
        <button class="btn btn-success" onclick="saveSig()">Save Signature</button>
      </div>

      <div id="memberPayoutsTab" class="hidden">
        <h2>Request Payout</h2>
        <button class="btn btn-success" onclick="reqPayoutModal()">+ Request Payout</button>
        <table>
          <thead><tr><th>Date</th><th>Amount</th><th>Reason</th><th>Status</th></tr></thead>
          <tbody id="memPayTable"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- MODAL -->
  <div id="modal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>
      <div id="modContent"></div>
    </div>
  </div>

  <script src="main.js"></script>
</body>
</html>